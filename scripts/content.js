(()=>{"use strict";const t=function(t,e,o){const n=document.createElement(t);if(null!==e)for(let t in e)n.setAttribute(t,e[t]);if(void 0!==o)return Array.isArray(o)?o.forEach((t=>{n.appendChild(t)})):"string"==typeof o?n.textContent=o:n.appendChild(o),n},e=function t(e,o){const n=document.querySelector(e);n?o(n):setTimeout((()=>{t(e,o)}),100)};function o(t,o){e(t,(t=>{const e=t.firstElementChild;for(const t of e.children)"H1"===t.tagName&&o(t.textContent)}))}!function(){const n=t("span",{style:"color:#0f0f0f;font-size:14px;font-family:Roboto,Arial,sans-serif;font-weight:bold;text-transform:capitalize;"},"notion"),i=t("div",{style:"display:flex;justify-content:center;align-item:center;padding:10px 16px;cursor:pointer; background:white;border-radius:18px;margin-right:.9rem;transition:opacity 0.6 ease-in;",onmouseover:"this.style.opacity=0.9",onmouseout:"this.style.opacity=1"},n);let a;e("#actions",(t=>{console.log("hi",i),t.insertAdjacentElement("afterbegin",i)})),navigation.addEventListener("navigate",(t=>{t.hashChange||(n.textContent="Notion",o("above-the-fold",(t=>{a=t})))})),a||o("#above-the-fold",(t=>{a=t})),i.addEventListener("click",(()=>{const t=window.location.href;n.textContent="Saving...";const e=localStorage.getItem("token"),o={link:t,type:"youtube",metaData:{title:a}};fetch("http://localhost:3000/api/bookmark",{method:"POST",headers:{"Content-Type":"application/json",Authorization:e},body:JSON.stringify(o)}).then((()=>{n.textContent="Saved"})).catch((t=>{i.textContent="Error"}))}))}();const n=t("p",{style:"color:#e7e9ea;font-family:TwitterChirp;font-size:15px;font-weight:bold;padding:15px 0 12px 3rem;margin:0;"},"Save to Notion"),i=t("div",{id:"notion",style:"cursor:pointer"},n);let a="";console.log(navigation),navigation.addEventListener("navigate",(t=>{t.hashChange||setInterval((()=>{e("[data-testid='caret']",(t=>{t.addEventListener("click",(()=>{n.textContent="Save to Notion",e("[data-testid='Dropdown']",(t=>{console.log(t,"eleme"),t.insertAdjacentElement("afterbegin",i)}))}))}))}))})),e("[data-testid='caret']",(t=>{console.log("work"),t.addEventListener("click",(()=>{n.textContent="Save to Notion",console.log("element"),e("[data-testid='Dropdown']",(t=>{console.log(t,"eleme"),t.insertAdjacentElement("afterbegin",i)}))}))})),i.addEventListener("click",(()=>{e("[data-testid='tweetText']",(t=>{a=t.firstChild.textContent}));const t=window.location.href;console.log(t),n.textContent="Saving...";const o=localStorage.getItem("token");console.log("ss",o);const i={link:t,type:"twitter",metaData:{title:a.slice(0,10)}};fetch("http://localhost:3000/api/bookmark",{method:"POST",headers:{"Content-Type":"application/json",Authorization:o},body:JSON.stringify(i)}).then((()=>{console.log("saved"),n.textContent="Saved"})).catch((t=>{n.textContent="error"}))})),chrome.runtime.onMessage.addListener((function(t,e,o){if(t.accessToken){var n=t.accessToken;localStorage.setItem("token",n),console.log("f",n)}}))})();