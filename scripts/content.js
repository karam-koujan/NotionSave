(()=>{"use strict";const t=function(t,e,n){const o=document.createElement(t);if(null!==e)for(let t in e)o.setAttribute(t,e[t]);if(void 0!==n)return Array.isArray(n)?n.forEach((t=>{o.appendChild(t)})):"string"==typeof n?o.textContent=n:o.appendChild(n),o},e=function t(e,n,o=!1){const a=o?document.querySelectorAll(e):document.querySelector(e);a?n(a):setTimeout((()=>{t(e,n)}),100)},n=function(t){const e=localStorage.getItem("token"),n={databaseId:localStorage.getItem("databaseId"),...t};return fetch("http://localhost:3000/api/bookmark",{method:"POST",headers:{"Content-Type":"application/json",Authorization:e},body:JSON.stringify(n)})};function o(t,n){e(t,(t=>{const e=t.firstElementChild;for(const t of e.children)"H1"===t.tagName&&n(t.textContent)}))}-1!==location.hostname.indexOf("youtube")&&(console.log("youtube...."),function(){const a=t("span",{style:"color:#0f0f0f;font-size:14px;font-family:Roboto,Arial,sans-serif;font-weight:bold;text-transform:capitalize;"},"notion"),i=t("div",{style:"display:flex;justify-content:center;align-item:center;padding:10px 16px;cursor:pointer; background:white;border-radius:18px;margin-right:.9rem;transition:opacity 0.6 ease-in;",onmouseover:"this.style.opacity=0.9",onmouseout:"this.style.opacity=1"},a);let r;e("#actions",(t=>{t.insertAdjacentElement("afterbegin",i)})),navigation.addEventListener("navigate",(t=>{t.hashChange||(a.textContent="Notion",console.log("change",r),o("#above-the-fold",(t=>{console.log(t),r=t})))})),r||o("#above-the-fold",(t=>{r=t})),i.addEventListener("click",(()=>{const t=window.location.href;a.textContent="Saving...",n({link:t,type:"youtube",metaData:{title:r}}).then((()=>{a.textContent="Saved"})).catch((t=>{i.textContent="Error"}))}))}()),-1!==location.hostname.indexOf("twitter")&&function(){const o=t("p",{style:"color:#e7e9ea;font-family:TwitterChirp;font-size:15px;font-weight:bold;padding:15px 0 12px 3rem;margin:0;"},"Save to Notion"),a=t("div",{id:"notion",style:"cursor:pointer"},o);let i="";navigation.addEventListener("navigate",(t=>{if(!t.hashChange){const t=setInterval((()=>{e("[data-testid='caret']",(n=>{n.addEventListener("click",(()=>{o.textContent="Save to Notion",e("[data-testid='Dropdown']",(e=>{e&&clearInterval(t),e.insertAdjacentElement("afterbegin",a)}))}))}))}))}})),e("[data-testid='caret']",(t=>{t.addEventListener("click",(()=>{o.textContent="Save to Notion",e("[data-testid='Dropdown']",(t=>{t.insertAdjacentElement("afterbegin",a)}))}))})),a.addEventListener("click",(()=>{e("[data-testid='tweetText']",(t=>{i=t.firstChild.textContent,i=i.length<10?i:i.slice(0,10)}));const t=window.location.href;o.textContent="Saving...",n({link:t,type:"twitter",metaData:{title:i}}).then((()=>{o.textContent="Saved"})).catch((()=>{o.textContent="error"}))}))}(),-1!==location.hostname.indexOf("reddit")&&(console.log("working!!!"),function(){const o=t("span",{},"Notion"),a=t("div",{style:"display:flex;justify-content:center;align-items:center; margin-inline:.6rem;cursor:pointer;"},o);navigation.addEventListener("navigate",(t=>{if(!t.hashChange){console.log(t.destination.url),o.textContent="Notion";let n=0;const i=setInterval((()=>{console.log("interval"),e("[data-adclicklocation='fl_unknown']",(t=>{for(let e of t)e.insertAdjacentElement("beforeend",a)}),!0),2===n&&clearInterval(i),n++}),500)}}));const i=setInterval((()=>{let t=0;e("[data-adclicklocation='fl_unknown']",(t=>{console.log(t);for(let e of t)e.insertAdjacentElement("beforeend",a);clearInterval(i)}),!0),2===t&&clearInterval(i),t++}),500);a.addEventListener("click",(()=>{const t=window.location.href;o.textContent="Saving...";const e=/\/([^/]+)\/$/.exec(t),a=e?e[1].replace(/_/g," "):"";n({link:t,type:"reddit",metaData:{title:a}}).then((()=>{o.textContent="Saved"})).catch((()=>{o.textContent="Error"}))}))}()),chrome.runtime.onMessage.addListener((function(t,e,n){if(t.accessToken){const e=t.accessToken;localStorage.setItem("token",e)}if(t.databaseId){const e=t.databaseId;localStorage.setItem("databaseId",e)}}))})();